import 'package:flutter/material.dart';
import 'package:flutter_map/flutter_map.dart';
import 'package:power_geojson/power_geojson.dart';

class StringGeoJSONPolygon extends StatelessWidget {
  const StringGeoJSONPolygon({
    Key? key,
    MapController? mapController,
  })  : _mapController = mapController,
        super(key: key);

  final MapController? _mapController;

  @override
  Widget build(BuildContext context) {
    return PowerGeoJSONPolygons.string(
      stringPolygons,
      bufferOptions: BufferOptions(
        buffer: 70,
        // buffersOnly: true,
        polygonBufferProperties: PolygonProperties(
          fillColor: const Color(0xFF54A805).withOpacity(0.5),
          borderStokeWidth: 0.3,
          label: 'Buffer',
          isDotted: false,
          borderColor: Colors.green,
        ),
      ),
      polygonProperties: const PolygonProperties(
        isDotted: false,
        fillColor: Color(0xFFA2210A),
        rotateLabel: true,
        label: 'String',
        labelStyle: TextStyle(
          fontStyle: FontStyle.italic,
          color: Colors.black,
          shadows: [
            Shadow(blurRadius: 10, color: Colors.white),
          ],
          decoration: TextDecoration.underline,
        ),
        labeled: true,
      ),
      mapController: _mapController,
    );
  }
}

class StringGeoJSONMultiPolygon extends StatelessWidget {
  const StringGeoJSONMultiPolygon({
    Key? key,
    MapController? mapController,
  })  : _mapController = mapController,
        super(key: key);

  final MapController? _mapController;

  @override
  Widget build(BuildContext context) {
    return PowerGeoJSONPolygons.string(
      stringMultiPolygons,
      bufferOptions: BufferOptions(
        buffer: 70,
        buffersOnly: true,
        polygonBufferProperties: PolygonProperties(
          fillColor: const Color(0xFF3E05A8).withOpacity(0.5),
          borderStokeWidth: 0.3,
          isDotted: false,
          labelStyle: const TextStyle(fontSize: 7),
          borderColor: Colors.green,
          layerProperties: {
            LayerPolygonIndexes.label: 'color',
            LayerPolygonIndexes.fillColor: 'color',
          },
        ),
      ),
      polygonProperties: const PolygonProperties(
        isDotted: false,
        fillColor: Color(0xFFA2210A),
        rotateLabel: true,
        label: 'String',
        layerProperties: {
          LayerPolygonIndexes.fillColor: 'color',
        },
        labelStyle: TextStyle(
          fontStyle: FontStyle.italic,
          color: Colors.black,
          shadows: [
            Shadow(blurRadius: 10, color: Colors.white),
          ],
          decoration: TextDecoration.underline,
        ),
        labeled: true,
      ),
      mapController: _mapController,
    );
  }
}

const stringPolygons =
    '''{"type":"FeatureCollection","features":[{"type":"Feature","id":0,"geometry":{"type":"Polygon","coordinates":[[[-2.4969688750220214,34.903073102238544],[-2.5207194295757915,34.904870441502069],[-2.519307234440197,34.891133634273679],[-2.4974824005259162,34.889207913634188],[-2.4969688750220214,34.903073102238544]],[[-2.511876522161069,34.89973005019344],[-2.5106440591146306,34.902770121879996],[-2.5082613009198367,34.901044676777815],[-2.5049747376874718,34.901537660667856],[-2.5053171651668915,34.899261525626983],[-2.5026741437222011,34.899072738243675],[-2.5030849641262893,34.894635878028566],[-2.5059668602185328,34.894942965459123],[-2.5063715273586542,34.892253119833896],[-2.5091651059574511,34.892992596412469],[-2.5089109738037725,34.895256682625451],[-2.5131089815389043,34.895704011525268],[-2.511876522161069,34.89973005019344]]]},"properties":{"FID":0,"color":"#6333FC","Id":0}},{"type":"Feature","id":1,"geometry":{"type":"Polygon","coordinates":[[[-2.473988608724115,34.910005696540722],[-2.4904214248477752,34.904742060126068],[-2.4891376110881014,34.885869997859146],[-2.4770697617473143,34.883302370339806],[-2.4647451496545583,34.891647159777577],[-2.473988608724115,34.910005696540722]],[[-2.4747975140462604,34.896029381279376],[-2.4805818653947256,34.893189790563213],[-2.4824223425817151,34.898553462683651],[-2.4762173094042765,34.9000784267771],[-2.4747975140462604,34.896029381279376]]]},"properties":{"FID":1,"color":"#93B7DD","Id":0}},{"type":"Feature","id":2,"geometry":{"type":"MultiPolygon","coordinates":[[[[-2.5083038934051403,34.860224825055411],[-2.5091651057388145,34.855443611755085],[-2.5030027996924575,34.853774653867561],[-2.5059402770414483,34.860662531789472],[-2.5083038934051403,34.860224825055411]]],[[[-2.5075466034138243,34.864429090179833],[-2.5086591025811313,34.867037708917081],[-2.5125030215139823,34.866356028712204],[-2.5195639971920807,34.858139620650391],[-2.5083038934051403,34.860224825055411],[-2.5075466034138243,34.864429090179833]]],[[[-2.5059402770414483,34.860662531789472],[-2.5022325114366786,34.861349155049595],[-2.5036618099686159,34.867923928296634],[-2.5070245139787621,34.867327586698735],[-2.5075466034138243,34.864429090179833],[-2.5059402770414483,34.860662531789472]]],[[[-2.5036618099686159,34.867923928296634],[-2.4864416021927918,34.870977758247008],[-2.490164662095891,34.882532082083941],[-2.5141719794015032,34.879964454564629],[-2.5086591025811313,34.867037708917081],[-2.5070245139787621,34.867327586698735],[-2.5054420458358413,34.876113013285654],[-2.5036618099686159,34.867923928296634]],[[-2.4930609459701056,34.874670006689414],[-2.4986481031677839,34.874177022055804],[-2.4999627307789067,34.878203063205319],[-2.4939647510077201,34.879106866904394],[-2.4930609459701056,34.874670006689414]]]]},"properties":{"FID":2,"color":"#150F7C","Id":0}}]}''';
const stringMultiPolygons =
    '''{"type":"FeatureCollection","features":[{"type":"Feature","id":0,"geometry":{"type":"MultiPolygon","coordinates":[[[[-2.4399595202571014,34.903955724198283],[-2.4426625336820464,34.899901204060868],[-2.4425607065319266,34.896642732016026],[-2.4385553489574887,34.892321162001359],[-2.4399595202571014,34.903955724198283]]],[[[-2.4452512950798755,34.896018061964227],[-2.4449763174101347,34.89924904901612],[-2.4538006373534693,34.908770025797025],[-2.4503905070543803,34.888309244002485],[-2.4452512950798755,34.896018061964227]]]]},"properties":{"FID":0,"color":"#3A8BCC","Id":0}},{"type":"Feature","id":1,"geometry":{"type":"Polygon","coordinates":[[[-2.4244192517476169,34.904613371189178],[-2.4246990019766637,34.906711497412573],[-2.4321362801591637,34.90636287499774],[-2.4303449507875365,34.897883915972201],[-2.4272679615131469,34.898855596847312],[-2.4276287606945752,34.903654208838162],[-2.4244192517476169,34.904613371189178]]]},"properties":{"FID":1,"color":"#E3233C","Id":0}},{"type":"Feature","id":2,"geometry":{"type":"MultiPolygon","coordinates":[[[[-2.4173196087838162,34.880824509485649],[-2.4174959137739513,34.884879524260072],[-2.4247244183716967,34.883645389328706],[-2.4273689932244866,34.88047189950538],[-2.4227850634795742,34.877122104691708],[-2.4173196087838162,34.880824509485649]]],[[[-2.4321362801591637,34.885902093203072],[-2.4465791849552687,34.885902093203072],[-2.4560071922528728,34.8822913670041],[-2.4503905070543803,34.875069914605902],[-2.4311333006594467,34.876474085905642],[-2.4321362801591637,34.885902093203072]],[[-2.4509213109204193,34.882295690356102],[-2.4418534671352177,34.882468000719328],[-2.4387303378904774,34.882403384570551],[-2.4384072559906906,34.878741784997032],[-2.4457089156998983,34.878440241791417],[-2.4509213109204193,34.882295690356102]]],[[[-2.4192981425625129,34.906964662697561],[-2.4231295815921894,34.906785063993119],[-2.423371183686502,34.904926586525882],[-2.4230538624028828,34.905021418051092],[-2.4221599173702182,34.901340467260511],[-2.4247658213923278,34.898873175400468],[-2.424251650549424,34.89594463756066],[-2.4188969507626177,34.900144402099386],[-2.4192981425625129,34.906964662697561]]]]},"properties":{"FID":2,"color":"#B35058","Id":0}},{"type":"Feature","id":3,"geometry":{"type":"Polygon","coordinates":[[[-2.4083280542842109,34.908857002925529],[-2.4083280542842109,34.902686328268935],[-2.4048019544804484,34.902510023278758],[-2.4051545644608456,34.908857002925529],[-2.4083280542842109,34.908857002925529]]]},"properties":{"FID":3,"color":"#97BC61","Id":0}},{"type":"Feature","id":4,"geometry":{"type":"Polygon","coordinates":[[[-2.4009232446963304,34.908857002925529],[-2.4003943297257555,34.904096768190399],[-2.3947525700396932,34.905507208111985],[-2.3936947400985851,34.910267442847115],[-2.4009232446963304,34.908857002925529]]]},"properties":{"FID":4,"color":"#CF9580","Id":0}},{"type":"Feature","id":5,"geometry":{"type":"Polygon","coordinates":[[[-2.4018047696472604,34.900041753416232],[-2.4081517492940332,34.895281518681138],[-2.4007469397061527,34.892813248818484],[-2.3931658251280528,34.894928908700741],[-2.3936947400985851,34.900394363396501],[-2.4018047696472604,34.900041753416232]]]},"properties":{"FID":5,"color":"#5F887C","Id":0}},{"type":"Feature","id":6,"geometry":{"type":"Polygon","coordinates":[[[-2.4088569692547432,34.888053014083397],[-2.4111489341271786,34.882411254397411],[-2.4040967345196531,34.881177119466045],[-2.3991601947944279,34.886642574161932],[-2.4033915145589009,34.891050198916624],[-2.4088569692547432,34.888053014083397]]]},"properties":{"FID":6,"color":"#C77000","Id":0}}]}''';
